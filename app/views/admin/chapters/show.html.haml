.container.py-4.py-lg-5
  .row
    .col
      %h1.mb-3
        %small
          = link_to edit_admin_chapter_path(@chapter), class: 'text-decoration-none' do
            %i.fas.fa-edit
        = @chapter.name
        %small.text-muted= @chapter.email

  .row
    .col-12.col-lg-4.d-md-flex.d-lg-block
      .card.border-info.mb-4
        .card-body
          %h3 Organisers
          %ul.list-unstyled.ms-0
            - @chapter.organisers.each do |organiser|
              %li
                = organiser.full_name
                - if organiser.mobile.present?
                  = organiser.mobile
                - else
                  %span.badge.bg-warning.text-dark Phone no. not set
          - if current_user.is_admin?
            = link_to 'Edit organisers', admin_chapter_organisers_path(@chapter), class: 'btn btn-primary btn-sm'

      .card.border-info.my-4.my-md-0.my-lg-4.ms-md-4.ms-lg-0
        .card-body
          %ul.nav.flex-column.ms-0.mb-0
            - @groups.each do |group|
              %li.nav-item
                = link_to [ :admin, group ], class: 'nav-link' do
                  #{group.name} (#{group.members.count})
              %li.nav-item
                = link_to admin_chapter_members_path(@chapter, type: group.name.downcase), class: 'nav-link' do
                  View #{group.name} emails
            %li.nav-item
              = link_to 'View all sponsors', admin_sponsors_path, class: 'nav-link'
            %li.nav-item
              = link_to 'View all workshops', admin_chapter_workshops_path(@chapter), class: 'nav-link'

      - if @how_you_found_us.data_present?
        .card.border-info.my-4.my-md-0.my-lg-4.ms-md-4.ms-lg-0
          .card-body
            %h3 How members found this chapter
            - @how_you_found_us.by_percentage.each do |(how, percent)|
              - label = t("member.details.edit.how_you_found_us_options.#{how}")
              .mb-3
                .d-flex.justify-content-between
                  %div= label
                  %div #{percent}%
                .progress
                  .progress-bar.bg-primary{ role: 'progressbar', style: "width: #{percent}%", "aria-valuenow": percent, "aria-valuemin": 0, "aria-valuemax": 100 }
            %div.text-muted.small= "Based on #{pluralize(@how_you_found_us.total_responses, 'response')}"

    .col-12.col-lg-8
      .mb-4.mt-md-4.mt-lg-0
        .d-md-flex.justify-content-between.align-items-center
          %h3 Upcoming Workshops
          = link_to 'New workshop', new_admin_workshop_path, class: 'btn btn-primary btn-sm'
        - if @workshops.any?
          %ul.list-unstyled.ms-0.mb-0
            - @workshops.each do |workshop|
              %li.py-2
                = link_to admin_workshop_path(workshop) do
                  = humanize_date(workshop.date_and_time, with_time: true)
                  - if workshop.invitable?
                    (#{workshop.invitations.accepted.count})
        - else
          There are no upcoming workshops.
      %div
        %h3 Latest subscribers
        = render partial: 'admin/subscriptions/index', locals: { subscribers: @subscribers }
